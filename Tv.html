<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyTube</title>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  background:#0f0f0f;
  color:white;
  font-family:Arial;
}
header{
  background:#202020;
  padding:12px;
  font-size:20px;
}
.container{
  padding:15px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:15px;
}
.card{
  background:#1f1f1f;
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
}
.card video{
  width:100%;
  height:120px;
  object-fit:cover;
}
.title{
  padding:8px;
  font-size:14px;
}
.player{
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:black;
  justify-content:center;
  align-items:center;
}
.player video{width:95%;max-width:800px}
.close{position:absolute;top:10px;right:15px;font-size:22px;cursor:pointer}
</style>
</head>
<body>

<header>MyTube ðŸŽ¬</header>

<div class="container" id="videoList"></div>

<div class="player" id="player">
  <span class="close" onclick="closePlayer()">âœ–</span>
  <video id="mainVideo" controls autoplay></video>
</div>

<script>
  // ðŸ”¥ Firebase Config (SAME AS ADMIN)
  const firebaseConfig = {
    apiKey: "AIzaSyDJ3w0sw73diwA9t-yMeQYZrq9AtflNwLw",
    authDomain: "tamilpadam-880da.firebaseapp.com",
    projectId: "tamilpadam-880da",
    storageBucket: "tamilpadam-880da.firebasestorage.app",
    messagingSenderId: "231920667182",
    appId: "1:231920667182:web:04ccd363eefeae32a1edbf"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const list = document.getElementById('videoList');

  // Load videos realtime
  db.collection('videos').orderBy('time','desc').onSnapshot(snapshot => {
    list.innerHTML = '';
    snapshot.forEach(doc => {
      const v = doc.data();
      list.innerHTML += `
        <div class="card" onclick="playVideo('${v.url}')">
          <video src="${v.url}" muted></video>
          <div class="title">${v.title}</div>
        </div>`;
    });
  });

  function playVideo(url){
    const player = document.getElementById('player');
    const video = document.getElementById('mainVideo');
    video.src = url;
    player.style.display = 'flex';
  }

  function closePlayer(){
    const player = document.getElementById('player');
    const video = document.getElementById('mainVideo');
    video.pause();
    video.src = '';
    player.style.display = 'none';
  }
</script>

</body>
</html>